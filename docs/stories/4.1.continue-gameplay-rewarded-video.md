# Story 4.1: Continue Gameplay Rewarded Video Option

## Status
Draft

## Story
**As a** player,
**I want** the option to watch a rewarded video to continue playing after game over,
**so that** I can extend promising games without feeling forced to watch ads.

## Acceptance Criteria
1. "Continue with Ad" option appears on game over screen alongside restart option
2. Ad loads and plays only when player explicitly selects continue option
3. Successful ad completion restores game state and clears some grid squares for continuation
4. Ad failure provides graceful fallback with clear messaging
5. Continue option limited to once per game session to prevent abuse
6. Clear visual indication that continue option requires watching an ad

## Tasks / Subtasks
- [ ] Task 1: Game Over Screen Integration (AC: 1, 6)
  - [ ] Add "Continue with Ad" option to game over screen
  - [ ] Place alongside existing restart option
  - [ ] Clear visual indication of ad requirement
  - [ ] Design consistent with overall UI style
- [ ] Task 2: Player-Initiated Ad Loading (AC: 2)
  - [ ] Implement ad loading only on explicit user selection
  - [ ] Never preload or auto-play continue ads
  - [ ] Show loading state during ad preparation
  - [ ] Handle ad loading delays gracefully
- [ ] Task 3: Game State Restoration (AC: 3)
  - [ ] Save game state before game over
  - [ ] Clear strategic grid squares after ad completion
  - [ ] Restore player to playable state
  - [ ] Ensure continue feels valuable and helpful
- [ ] Task 4: Ad Failure Handling (AC: 4)
  - [ ] Detect ad loading/playback failures
  - [ ] Provide clear error messaging
  - [ ] Fallback to normal game over flow
  - [ ] Log failures for optimization
- [ ] Task 5: Session Limiting (AC: 5)
  - [ ] Track continue usage per game session
  - [ ] Limit to once per session
  - [ ] Hide continue option after use
  - [ ] Reset limitation on new game start

## Dev Notes

### Architecture Context
Integrates with existing AdMob integration, extending it for rewarded continue gameplay.

**AdMob Integration:**
- Builds on existing AdMob SDK integration from Story 1.2
- Uses rewarded video ad units configured in external services setup
- Player-controlled monetization philosophy [Source: architecture/introduction.md#player-controlled-monetization]
- Never forced ads, always player choice [Source: prd/epic-4-monetization-polish.md#epic-goal]

**Revenue Targets:**
- Target 85% completion rates for revenue optimization [Source: prd/epic-4-monetization-polish.md#acceptance-criteria]
- $9-17 eCPM revenue targets [Source: prd/epic-4-monetization-polish.md#acceptance-criteria]

### File Locations
- Continue Manager: `BlockPuzzlePro/Monetization/ContinueManager.swift`
- Game Over Screen: `BlockPuzzlePro/Views/GameOverView.swift`
- Ad Integration: Extends existing `BlockPuzzlePro/Ads/AdManager.swift`

### Game State Restoration Logic
```swift
struct GameContinueState {
    let gridState: [[GridCell]]
    let currentScore: Int
    let unlockedBlocks: [BlockType]
    let sessionData: SessionData
    
    func createContinueState() -> GameState {
        // Clear 3-5 strategic grid squares
        // Restore score and progression
        // Provide new block set
        // Reset continue availability to false
    }
}
```

### Ad Integration Details
- Use existing rewarded video ad unit from Story 1.2 setup
- Implement completion callbacks for state restoration
- Handle network failures gracefully with fallback messaging
- Track completion rates for optimization in Story 4.4

### Player Experience Considerations
- Continue option should feel like a valuable "second chance"
- Grid clearing should provide meaningful help without making game too easy
- Clear messaging that ads are optional and player-controlled
- Maintain 60fps performance during ad integration

## Change Log
| Date       | Version | Description            | Author   |
| ---------- | ------- | ---------------------- | -------- |
| 2025-01-15 | 1.0     | Initial story creation | Bob (SM) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

## QA Results
*Results from QA Agent review will be populated here after implement